{% extends "layout.html" %} {% block title %}Login{% endblock %} {% block
content %}
<style>
  .gradient-bg {
    background: linear-gradient(-45deg, #0f172a, #1e3a8a, #3b82f6, #4f46e5);
    background-size: 400% 400%;
    animation: gradient 15s ease infinite;
  }
  @keyframes gradient {
    0% {
      background-position: 0% 50%;
    }
    50% {
      background-position: 100% 50%;
    }
    100% {
      background-position: 0% 50%;
    }
  }
  @keyframes fadeIn {
    from {
      opacity: 0;
      transform: translateY(10px);
    }
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }
  .form-container {
    animation: fadeIn 0.5s ease-out forwards;
  }
</style>

<div
  class="min-h-screen flex items-center justify-center w-full gradient-bg px-4"
>
  <div
    class="form-container w-full max-w-md bg-white/20 backdrop-blur-lg rounded-2xl shadow-2xl p-8 text-white"
  >
    <div class="text-center mb-8">
      <svg
        class="mx-auto h-12 w-auto text-white"
        xmlns="http://www.w3.org/2000/svg"
        fill="none"
        viewBox="0 0 24 24"
        stroke-width="1.5"
        stroke="currentColor"
      >
        <path
          stroke-linecap="round"
          stroke-linejoin="round"
          d="M12 6.042A8.967 8.967 0 0 0 6 3.75c-1.052 0-2.062.18-3 .512v14.25A8.987 8.987 0 0 1 6 18c2.305 0 4.408.867 6 2.292m0-14.25a8.966 8.966 0 0 1 6-2.292c1.052 0 2.062.18 3 .512v14.25A8.987 8.987 0 0 0 18 18a8.967 8.967 0 0 0-6 2.292m0-14.25v14.25"
        />
      </svg>
      <h1 class="text-3xl font-bold mt-4">Login E-Perpus</h1>
      <p class="text-blue-200 mt-2">Selamat Datang Kembali</p>
    </div>
    <!-- Flash Messages -->
    {% with messages = get_flashed_messages(with_categories=true) %} {% if
    messages %} {% for category, message in messages %}
    <div
      class="p-3 mb-4 text-sm rounded-lg {% if category == 'danger' %} bg-red-500/80 {% elif category == 'success' %} bg-green-500/80 {% else %} bg-blue-500/80 {% endif %}"
      role="alert"
    >
      {{ message }}
    </div>
    {% endfor %} {% endif %} {% endwith %}
    <form action="{{ url_for('login') }}" method="POST" class="space-y-6">
      <input type="hidden" name="csrf_token" value="{{ csrf_token() }}" />

      <!-- Username -->
      <div>
        <label for="username" class="block text-sm font-medium text-blue-100"
          >Username</label
        >
        <input
          type="text"
          name="username"
          id="username"
          class="mt-1 block w-full px-3 py-2 bg-white/10 border border-white/30 rounded-md shadow-sm placeholder-gray-300 focus:outline-none focus:ring-2 focus:ring-white/50 focus:border-white/50"
          required
          placeholder="nama_pengguna"
        />
      </div>

      <!-- Password -->
      <div>
        <div class="flex justify-between items-center">
          <label for="password" class="block text-sm font-medium text-blue-100"
            >Password</label
          >
          <div class="text-sm">
            <a
              href="{{ url_for('request_password_reset') }}"
              class="font-medium text-blue-300 hover:text-white"
            >
              Lupa Password?
            </a>
          </div>
        </div>
        <div class="mt-1 relative">
          <input
            type="password"
            name="password"
            id="password"
            class="block w-full px-3 py-2 bg-white/10 border border-white/30 rounded-md shadow-sm placeholder-gray-300 focus:outline-none focus:ring-2 focus:ring-white/50 focus:border-white/50"
            required
            placeholder="••••••••"
          />
          <button
            type="button"
            id="togglePassword"
            class="absolute inset-y-0 right-0 px-3 flex items-center text-gray-300 hover:text-white"
          >
            <!-- Ikon mata terbuka -->
            <svg
              id="eye-open"
              class="h-5 w-5"
              xmlns="http://www.w3.org/2000/svg"
              viewBox="0 0 20 20"
              fill="currentColor"
            >
              <path d="M10 12a2 2 0 100-4 2 2 0 000 4z" />
              <path
                fill-rule="evenodd"
                d="M.458 10C1.732 5.943 5.522 3 10 3s8.268 2.943 9.542 7c-1.274 4.057-5.022 7-9.542 7S1.732 14.057.458 10zM14 10a4 4 0 11-8 0 4 4 0 018 0z"
                clip-rule="evenodd"
              />
            </svg>
            <!-- Ikon mata tertutup -->
            <svg
              id="eye-closed"
              class="h-5 w-5 hidden"
              xmlns="http://www.w3.org/2000/svg"
              viewBox="0 0 20 20"
              fill="currentColor"
            >
              <path
                fill-rule="evenodd"
                d="M3.707 2.293a1 1 0 00-1.414 1.414l14 14a1 1 0 001.414-1.414l-1.473-1.473A10.014 10.014 0 0019.542 10C18.268 5.943 14.478 3 10 3a9.958 9.958 0 00-4.512 1.074l-1.78-1.781zm4.261 4.26l1.514 1.515a2.003 2.003 0 012.45 2.45l1.514 1.514a4 4 0 00-5.478-5.478z"
                clip-rule="evenodd"
              />
              <path
                d="M12.454 16.697L9.75 13.992a4 4 0 01-3.742-3.742L2.303 6.546A10.048 10.048 0 01.458 10c1.274 4.057 5.022 7 9.542 7 .847 0 1.669-.105 2.454-.303z"
              />
            </svg>
          </button>
        </div>
      </div>

      <!-- Elemen reCAPTCHA akan muncul di sini -->
      {% if show_captcha %}
      <div class="flex justify-center">
        <div class="g-recaptcha" data-sitekey="{{ recaptcha_site_key }}"></div>
      </div>
      {% endif %}

      <!-- Submit Button -->
      <div>
        <button
          type="submit"
          class="w-full flex justify-center py-3 px-4 border border-transparent rounded-md shadow-lg text-sm font-bold text-blue-600 bg-white hover:bg-blue-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-offset-blue-700 focus:ring-white transition-colors duration-300"
        >
          LOGIN
        </button>
      </div>
    </form>

    <p class="mt-8 text-center text-sm text-blue-200">
      Belum punya akun?
      <a
        href="{{ url_for('register') }}"
        class="font-medium text-white hover:underline"
      >
        Daftar di sini
      </a>
    </p>
  </div>
</div>
<!-- Script Google reCAPTCHA -->
<script src="https://www.google.com/recaptcha/api.js" async defer></script>
<!-- Script untuk toggle password -->
<script>
  const togglePassword = document.getElementById("togglePassword");
  const password = document.getElementById("password");
  const eyeOpen = document.getElementById("eye-open");
  const eyeClosed = document.getElementById("eye-closed");

  togglePassword.addEventListener("click", function () {
    const type =
      password.getAttribute("type") === "password" ? "text" : "password";
    password.setAttribute("type", type);

    // Ganti ikon
    eyeOpen.classList.toggle("hidden");
    eyeClosed.classList.toggle("hidden");
  });
</script>
{% endblock %}
